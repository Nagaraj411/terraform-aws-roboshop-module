# â˜ï¸ terraform-aws-roboshop-module

A **Terraform module** to automate the **golden AMI creation** and **autoscaling deployment** of Roboshop microservices in AWS. This module builds a custom AMI for each component, sets up a Launch Template, and connects an Auto Scaling Group to an ALB target group â€” all triggered from Terraform.

---

## ğŸš€ What It Does

This module automates:
ğŸ”¹ ğŸ–¥ï¸ Launches a temporary EC2 instance  
ğŸ”¹ ğŸ” Uploads and runs a bootstrap shell script  
ğŸ”¹ â¹ï¸ Stops the instance and creates a custom AMI  
ğŸ”¹ ğŸ§½ Terminates the temporary EC2 instance  
ğŸ”¹ ğŸ“¦ Creates a Launch Template using the AMI  
ğŸ”¹ ğŸš€ Launches an Auto Scaling Group from the template  
ğŸ”¹ ğŸ”— Registers instances with an ALB Target Group  
ğŸ”¹ âš™ï¸ Configures listener rules for HTTP routing  
ğŸ”¹ ğŸ“ˆ Applies CPU-based Auto Scaling policies 

---

## ğŸ“¦ AWS Resources Used

| ğŸ§± **Resource Type**           | ğŸ” **Purpose**                                         |
|-------------------------------|----------------------------------------------------------|
| ğŸ–¥ï¸ `aws_instance`            | Launches a temporary EC2 for app setup and AMI build     |
| ğŸ“ `terraform_data`          | Uploads bootstrap script, executes remote/local tasks    |
| â¹ï¸ `aws_ec2_instance_state`  | Stops the EC2 instance before AMI creation               |
| ğŸ“¸ `aws_ami_from_instance`   | Creates a custom AMI from the configured instance        |
| ğŸ§¬ `aws_launch_template`     | Defines EC2 configuration using the created AMI          |
| ğŸ“ˆ `aws_autoscaling_group`   | Launches and scales EC2 instances across subnets         |
| âš™ï¸ `aws_autoscaling_policy`  | Auto scales based on CPU utilization metrics             |
| ğŸ¯ `aws_lb_target_group`     | Registers the instances for ALB-based routing            |
| ğŸŒ `aws_lb_listener_rule`    | Routes HTTP traffic to services based on host headers    |

---

âœ… This setup ensures:

âœ¨ **Immutable Deployments**  
ğŸ“ **Horizontal Scalability**  
ğŸŒ **Load-Balanced Infrastructure**  
ğŸ§© All powered via **Terraform Infrastructure as Code**

---

## âš™ï¸ Input Variables

| ğŸ§© Variable        | ğŸ“– Description                          | ğŸ§ª Example                  |
|-------------------|------------------------------------------|----------------------------|
| `project`         | Name of the project                      | `"roboshop"`               |
| `environment`     | Deployment environment                   | `"dev"`                    |
| `component`       | Microservice/component name              | `"user"`                   |
| `rule_priority`   | ALB listener rule priority               | `10`                       |

ğŸ“Œ **Local variables** like `ami_id`, `vpc_id`, `sg_id`, `subnet_id`, etc., must be pre-defined or passed as locals from the root module.