# â˜ï¸ terraform-aws-roboshop-module

A **Terraform module** to automate the **golden AMI creation** and **autoscaling deployment** of Roboshop microservices in AWS. This module builds a custom AMI for each component, sets up a Launch Template, and connects an Auto Scaling Group to an ALB target group â€” all triggered from Terraform.

---

## ğŸš€ What It Does

This module automates:

ğŸ”¹ Launching a temporary EC2 instance  
ğŸ”¹ Bootstrapping with a shell script  
ğŸ”¹ Stopping and creating a custom AMI  
ğŸ”¹ Terminating the temp instance  
ğŸ”¹ Creating a Launch Template with AMI  
ğŸ”¹ Launching an Auto Scaling Group  
ğŸ”¹ Registering with ALB Target Group  
ğŸ”¹ Setting up CPU-based Auto Scaling  
ğŸ”¹ Defining Listener Rules for routing

---

## ğŸ“¦ AWS Resources Used

| ğŸ§± Resource Type              | ğŸ” Purpose                                               |
|-----------------------------|---------------------------------------------------------|
| `aws_instance`              | Launch temporary instance for bootstrap                |
| `terraform_data`            | Upload and execute shell script, manage cleanup        |
| `aws_ami_from_instance`     | Create custom AMI from preconfigured EC2               |
| `aws_launch_template`       | Define EC2 launch config using custom AMI              |
| `aws_autoscaling_group`     | Spin up scalable EC2 instances                         |
| `aws_autoscaling_policy`    | Auto scale based on CPU usage                          |
| `aws_lb_target_group`       | Register instances for load balancing                  |
| `aws_lb_listener_rule`      | Host-based routing to services                         |
| `aws_ec2_instance_state`    | Stop instance before AMI creation                      |

---

## âš™ï¸ Input Variables

| ğŸ§© Variable        | ğŸ“– Description                          | ğŸ§ª Example                  |
|-------------------|------------------------------------------|----------------------------|
| `project`         | Name of the project                      | `"roboshop"`               |
| `environment`     | Deployment environment                   | `"dev"`                    |
| `component`       | Microservice/component name              | `"user"`                   |
| `rule_priority`   | ALB listener rule priority               | `10`                       |

ğŸ“Œ **Local variables** like `ami_id`, `vpc_id`, `sg_id`, `subnet_id`, etc., must be pre-defined or passed as locals from the root module.